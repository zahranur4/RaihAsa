document.addEventListener("DOMContentLoaded",function(){if(window.toggleProfileMenu=function(){const e=document.getElementById("profileMenu");e&&e.classList.toggle("show")},document.addEventListener("click",function(e){const n=document.querySelector(".admin-profile");if(n&&!n.contains(e.target)){const t=document.getElementById("profileMenu");t&&t.classList.remove("show")}}),document.getElementById("donationTrendChart")){const e=document.getElementById("donationTrendChart").getContext("2d");new Chart(e,{type:"line",data:{labels:["Jan","Feb","Mar","Apr","Mei","Jun"],datasets:[{label:"Jumlah Donasi",data:[10,15,20,18,25,30],borderColor:"#000957",backgroundColor:"rgba(0, 9, 87, 0.1)",borderWidth:2,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1}})}if(document.getElementById("donationCategoryChart")){const e=document.getElementById("donationCategoryChart").getContext("2d");new Chart(e,{type:"doughnut",data:{labels:["Makanan","Pakaian","Pendidikan"],datasets:[{data:[50,30,20],backgroundColor:["#000957","#17a2b8","#ffc107"]}]},options:{responsive:!0,maintainAspectRatio:!1}})}});window.viewWishlistDetail=function(e){const t={WL001:{nama:"Susu Formula Usia 1-3 Tahun",kategori:"Makanan",jumlah:"20 kaleng",terkumpul:"20 kaleng",status:"Terkumpul",deskripsi:"Susu formula sangat dibutuhkan untuk 15 anak balita yang berada di bawah asuhan kami.",batasWaktu:"30 Juni 2023",donatur:[{nama:"Ahmad Fadli",jumlah:"10 kaleng",tanggal:"15 Jun 2023"},{nama:"Siti Nurhaliza",jumlah:"5 kaleng",tanggal:"20 Jun 2023"},{nama:"Budi Santoso",jumlah:"5 kaleng",tanggal:"25 Jun 2023"}]}}[e];if(t){document.getElementById("wishlistDetailContent").innerHTML=`
            <p><strong>Nama Item:</strong> ${t.nama}</p>
            <p><strong>Kategori:</strong> ${t.kategori}</p>
            <p><strong>Jumlah Dibutuhkan:</strong> ${t.jumlah}</p>
            <p><strong>Jumlah Terkumpul:</strong> ${t.terkumpul}</p>
            <p><strong>Status:</strong> <span class="badge bg-success">${t.status}</span></p>
            <p><strong>Batas Waktu:</strong> ${t.batasWaktu}</p>
            <p><strong>Deskripsi:</strong> ${t.deskripsi}</p>
        `;let a="";t.donatur.forEach(i=>{a+=`<tr><td>${i.nama}</td><td>${i.jumlah}</td><td>${i.tanggal}</td></tr>`}),document.getElementById("donaturList").innerHTML=a,new bootstrap.Modal(document.getElementById("detailWishlistModal")).show()}};window.editWishlist=function(e){alert("Membuka form edit untuk wishlist ID: "+e)};window.hapusWishlist=function(e,n){if(confirm("Apakah Anda yakin ingin menghapus wishlist ini?")){const t=e.closest("tr");t.style.transition="opacity 0.5s",t.style.opacity="0",setTimeout(()=>t.remove(),500),alert("Wishlist berhasil dihapus.")}};window.simpanWishlistBaru=function(){alert("Wishlist baru berhasil ditambahkan!"),bootstrap.Modal.getInstance(document.getElementById("addWishlistModal")).hide(),document.getElementById("addWishlistForm").reset()};let o=!1,s={};function r(){s={},document.querySelectorAll("#profileForm input[name], #profileForm textarea[name], #profileForm select[name]").forEach(n=>{s[n.name]=n.type==="checkbox"?n.checked:n.value})}function l(){document.querySelectorAll("#profileForm input[name], #profileForm textarea[name], #profileForm select[name]").forEach(n=>{const t=s[n.name];typeof t<"u"&&(n.type==="checkbox"?n.checked=t:n.value=t)})}window.toggleEditMode=function(){o=!o;const e=document.querySelectorAll("#profileForm input, #profileForm textarea, #profileForm select"),n=document.getElementById("editProfileBtn"),t=document.getElementById("saveActions");o?(r(),e.forEach(a=>a.disabled=!1),n.style.display="none",t.style.display="block"):(e.forEach(a=>a.disabled=!0),n.style.display="block",t.style.display="none")};window.cancelEdit=function(){l(),o&&toggleEditMode()};window.saveProfile=function(){const e=document.getElementById("profileForm"),n=document.querySelector("#saveActions button.btn-success"),t=document.querySelector("#saveActions button.btn-secondary");if(!e){alert("Form not found");return}n&&(n.disabled=!0,n.innerHTML='<i class="fas fa-spinner fa-spin"></i> Menyimpan...'),t&&(t.disabled=!0),e.submit()};window.confirmReceipt=function(e){confirm("Apakah Anda yakin telah menerima donasi ini?")&&alert(`Donasi ${e} telah dikonfirmasi diterima.`)};window.viewDonationDetail=function(e){const t={D002:{donatur:"Siti Nurhaliza",item:"Buku Tulis 60 Lembar",jumlah:"35 pcs",tanggal:"10 Jun 2023",catatan:"Semoga buku-buku ini bermanfaat untuk anak-anak."}}[e];t&&(document.getElementById("donationDetailContent").innerHTML=`
            <p><strong>Donatur:</strong> ${t.donatur}</p>
            <p><strong>Item:</strong> ${t.item}</p>
            <p><strong>Jumlah:</strong> ${t.jumlah}</p>
            <p><strong>Tanggal Donasi:</strong> ${t.tanggal}</p>
            <p><strong>Catatan dari Donatur:</strong> ${t.catatan}</p>
        `,new bootstrap.Modal(document.getElementById("donationDetailModal")).show())};window.claimFood=function(e){confirm("Apakah Anda yakin ingin mengklaim makanan ini? Segera ambil sesuai jam operasional yang ditentukan.")&&alert(`Food Rescue ${e} berhasil diklaim!`)};window.changePassword=function(){const e=document.getElementById("currentPassword").value,n=document.getElementById("newPassword").value,t=document.getElementById("confirmPassword").value;if(!e||!n||!t){alert("Semua field harus diisi!");return}if(n!==t){alert("Password baru dan konfirmasi tidak cocok!");return}alert("Password berhasil diubah!")};window.saveNotificationSettings=function(){alert("Pengaturan notifikasi berhasil disimpan!")};document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("toggleSidebar"),n=document.querySelector(".sidebar"),t=document.querySelector(".main-content");e&&e.addEventListener("click",function(){n.classList.toggle("collapsed"),t.classList.toggle("expanded")})});
