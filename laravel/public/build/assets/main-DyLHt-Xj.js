document.addEventListener("DOMContentLoaded",function(){const a=document.querySelectorAll(".category-btn"),f=document.querySelectorAll(".rescue-card"),h=document.querySelectorAll(".wishlist-card");a.length>0&&a.forEach(e=>{e.addEventListener("click",function(){a.forEach(n=>n.classList.remove("active")),this.classList.add("active");const t=this.getAttribute("data-category");f.forEach(n=>{t==="all"||n.getAttribute("data-category")===t?n.style.display="block":n.style.display="none"}),h.forEach(n=>{t==="all"||n.getAttribute("data-category")===t?n.style.display="block":n.style.display="none"})})});const u=document.querySelectorAll(".feature-card, .benefit-card, .help-method, .stat-item, .about-image, .food-rescue-image, .wishlist-image, .volunteer-image, .testimonial-card, .small-category-card");u.forEach(e=>{e.classList.add("animate-on-scroll")});function m(){const e=window.innerHeight/5*4;u.forEach(t=>{t.getBoundingClientRect().top<e&&t.classList.add("animated")})}window.addEventListener("scroll",m),m(),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const n=this.getAttribute("href");if(n==="#")return;const o=document.querySelector(n);o&&window.scrollTo({top:o.offsetTop-80,behavior:"smooth"})})});const i=document.getElementById("donationModal");i&&i.addEventListener("show.bs.modal",function(){document.getElementById("loginPrompt").style.display="block",document.getElementById("donationForm").style.display="none"});const y=document.getElementById("donate-modal");y&&y.addEventListener("show.bs.modal",function(){document.getElementById("carouselLoginPrompt").style.display="block",document.getElementById("carouselLoginForm").style.display="none",document.getElementById("carouselDonationForm").style.display="none"});const p=document.querySelector("#carouselLoginPrompt .btn-primary");p&&p.addEventListener("click",function(e){e.preventDefault(),document.getElementById("carouselLoginPrompt").style.display="none",document.getElementById("carouselLoginForm").style.display="block"});const g=document.getElementById("carousel-login-form");g&&g.addEventListener("submit",function(e){e.preventDefault();const t=document.getElementById("carousel-email").value,n=document.getElementById("carousel-password").value;if(t&&n){const o=document.querySelectorAll("#donate-modal .step");o[0].classList.remove("active"),o[1].classList.add("active"),document.getElementById("carouselLoginForm").style.display="none",document.getElementById("carouselDonationForm").style.display="block"}else alert("Silakan isi email dan password")});const l=document.getElementById("carousel-donation-form");l&&l.addEventListener("submit",function(e){e.preventDefault();const t={foodType:document.getElementById("carousel-food-type").value,quantity:document.getElementById("carousel-quantity").value,expiry:document.getElementById("carousel-expiry").value,description:document.getElementById("carousel-description").value,pickupMethod:document.getElementById("carousel-pickup-method").value};if(v(t)){const n=document.querySelectorAll("#donate-modal .step");n[1].classList.remove("active"),n[2].classList.add("active"),document.getElementById("carouselDonationForm").style.display="none";const o=document.createElement("div");o.className="matching-screen text-center",o.innerHTML=`
                    <div class="spinner-border text-primary mb-3" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <h4>Mencocokkan dengan Penerima</h4>
                    <p>Sistem kami sedang mencari penerima yang paling sesuai untuk donasi Anda</p>
                `,l.parentNode.appendChild(o),setTimeout(()=>{n[2].classList.remove("active"),n[3].classList.add("active"),o.style.display="none";const c=document.createElement("div");c.className="confirmation-screen",c.innerHTML=`
                        <h4>Donasi Berhasil Dibuat!</h4>
                        <div class="alert alert-success">
                            Donasi Anda telah berhasil dibuat dan sedang menunggu konfirmasi dari penerima.
                        </div>
                        <p><strong>Detail Donasi:</strong></p>
                        <ul>
                            <li>Jenis: ${document.getElementById("carousel-food-type").value}</li>
                            <li>Jumlah: ${document.getElementById("carousel-quantity").value}</li>
                            <li>Kadaluwarsa: ${new Date(document.getElementById("carousel-expiry").value).toLocaleString()}</li>
                            <li>Metode: ${document.getElementById("carousel-pickup-method").value==="self-delivery"?"Pengantaran":"Pengambilan"}</li>
                        </ul>
                        <button type="button" class="btn btn-primary w-100" data-bs-dismiss="modal">Selesai</button>
                    `,o.parentNode.appendChild(c)},3e3)}}),document.querySelectorAll(".carousel-register-link").forEach(e=>{e.addEventListener("click",function(t){t.preventDefault(),window.location.href="/register"})}),document.getElementById("login-form"),document.querySelectorAll(".register-link").forEach(e=>{e.addEventListener("click",function(t){t.preventDefault(),window.location.href="/register"})});const s=document.getElementById("foodRescueForm");s&&s.addEventListener("submit",function(e){e.preventDefault();const t={type:"food-rescue",foodType:document.getElementById("food-type").value,foodName:document.getElementById("food-name").value,quantity:document.getElementById("food-quantity").value,expiry:document.getElementById("food-expiry").value,description:document.getElementById("food-description").value,pickupMethod:document.getElementById("pickup-method").value};E(t)&&(console.log("Food Rescue form data:",t),alert("Donasi Food Rescue berhasil dikirim!"),s.reset(),bootstrap.Modal.getInstance(i).hide())});const r=document.getElementById("wishlistForm");r&&r.addEventListener("submit",function(e){e.preventDefault();const t={type:"wishlist",recipient:document.getElementById("wishlist-recipient").value,item:document.getElementById("wishlist-item").value,quantity:document.getElementById("wishlist-quantity").value,description:document.getElementById("wishlist-description").value,deliveryMethod:document.getElementById("delivery-method").value};B(t)&&(console.log("Wishlist form data:",t),alert("Donasi Wishlist berhasil dikirim!"),r.reset(),bootstrap.Modal.getInstance(i).hide())});const d=document.getElementById("otherForm");d&&d.addEventListener("submit",function(e){e.preventDefault();const t={type:"other",donationType:document.getElementById("other-type").value,itemName:document.getElementById("other-name").value,quantity:document.getElementById("other-quantity").value,description:document.getElementById("other-description").value,recipient:document.getElementById("other-recipient").value,deliveryMethod:document.getElementById("delivery-method-other").value};I(t)&&(console.log("Other form data:",t),alert("Donasi berhasil dikirim!"),d.reset(),bootstrap.Modal.getInstance(i).hide())}),[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(e){return new bootstrap.Tooltip(e)});function v(e){return!e.foodType||!e.quantity||!e.expiry||!e.pickupMethod?(alert("Silakan lengkapi semua field yang wajib diisi"),!1):new Date(e.expiry)<=new Date?(alert("Tanggal kadaluwarsa harus di masa depan"),!1):!0}function E(e){return!e.foodType||!e.foodName||!e.quantity||!e.expiry||!e.pickupMethod?(alert("Silakan lengkapi semua field yang wajib diisi"),!1):new Date(e.expiry)<=new Date?(alert("Tanggal kadaluwarsa harus di masa depan"),!1):!0}function B(e){return!e.recipient||!e.item||!e.quantity||!e.deliveryMethod?(alert("Silakan lengkapi semua field yang wajib diisi"),!1):!0}function I(e){return!e.donationType||!e.itemName||!e.quantity||!e.recipient||!e.deliveryMethod?(alert("Silakan lengkapi semua field yang wajib diisi"),!1):!0}});
