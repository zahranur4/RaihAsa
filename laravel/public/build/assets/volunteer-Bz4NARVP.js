document.addEventListener("DOMContentLoaded",function(){const a=v();h(a),g();const o=document.getElementById("volunteerModal");o&&o.addEventListener("show.bs.modal",function(){const c=document.getElementById("volunteerLoginPrompt"),s=document.getElementById("volunteerInfo");a?(c.style.display="none",s.style.display="block"):(c.style.display="block",s.style.display="none")});const r=document.querySelectorAll(".filter-btn"),l=document.querySelectorAll(".activity-card");r.forEach(c=>{c.addEventListener("click",function(){r.forEach(t=>t.classList.remove("active")),this.classList.add("active");const s=this.getAttribute("data-filter");l.forEach(t=>{s==="all"||t.getAttribute("data-category")===s?t.style.display="block":t.style.display="none"})})});const i=document.querySelectorAll(".management-tab"),e=document.querySelectorAll(".tab-pane");i.forEach(c=>{c.addEventListener("click",function(){i.forEach(t=>t.classList.remove("active")),this.classList.add("active");const s=this.getAttribute("data-tab");e.forEach(t=>{t.classList.remove("active")}),document.getElementById(s).classList.add("active")})});const n=document.querySelectorAll(".rating i");n.forEach(c=>{c.addEventListener("click",function(){const s=this.getAttribute("data-rating");n.forEach(t=>{t.classList.remove("fas"),t.classList.add("far")});for(let t=0;t<s;t++)n[t].classList.remove("far"),n[t].classList.add("fas")}),c.addEventListener("mouseover",function(){const s=this.getAttribute("data-rating");n.forEach(t=>{t.classList.remove("fas"),t.classList.add("far")});for(let t=0;t<s;t++)n[t].classList.remove("far"),n[t].classList.add("fas")})});const m=document.getElementById("facePhoto"),d=document.querySelector(".photo-preview");m&&d&&m.addEventListener("change",function(c){const s=c.target.files[0];if(s){const t=new FileReader;t.onload=function(f){d.style.backgroundImage=`url(${f.target.result})`,d.innerHTML=""},t.readAsDataURL(s)}});const u=document.querySelector(".volunteer-form");u&&u.addEventListener("submit",function(c){c.preventDefault();const s=document.createElement("div");s.className="alert alert-success alert-dismissible fade show",s.innerHTML=`
                <strong>Terima kasih!</strong> Pendaftaran volunteer Anda telah berhasil dikirim. Tunggu verifikasi dari admin.
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            `,u.parentNode.insertBefore(s,u),u.reset(),d.style.backgroundImage="",d.innerHTML='<i class="fas fa-camera"></i><span>Upload Foto</span>',setTimeout(()=>{s.classList.remove("show"),setTimeout(()=>{s.remove()},150)},5e3)})});function g(){const a=new IntersectionObserver(e=>{e.forEach(n=>{if(n.isIntersecting){if(n.target.classList.add("animate-in"),n.target.classList.contains("progress-bar")){const m=n.target.getAttribute("aria-valuenow");n.target.style.width=m+"%"}n.target.classList.contains("counter")&&y(n.target)}})},{threshold:.1}),o=document.querySelectorAll(".category-card, .activity-card, .photo-item, .management-card, .match-item, .step"),r=document.querySelectorAll(".section-title, .lead, .text-center h2, .text-center p"),l=document.querySelectorAll(".progress-bar"),i=document.querySelectorAll(".counter");o.forEach(e=>{e.classList.add("fade-in"),a.observe(e)}),r.forEach(e=>{e.classList.add("slide-up"),a.observe(e)}),l.forEach(e=>{e.style.width="0%",a.observe(e)}),i.forEach(e=>{a.observe(e)})}function y(a){const o=parseInt(a.getAttribute("data-target")),l=o/(2e3/16);let i=0;const e=()=>{i+=l,i<o?(a.textContent=Math.ceil(i),requestAnimationFrame(e)):a.textContent=o};e()}function v(){return localStorage.getItem("isLoggedIn")==="true"}function h(a){const o=document.getElementById("loginRequired"),r=document.getElementById("verification-form"),l=document.getElementById("activities"),i=document.querySelector(".smart-matching"),e=document.querySelector(".activity-management");a?(o&&(o.style.display="none"),r&&(r.style.display="block"),l&&(l.style.display="block"),i&&(i.style.display="block"),e&&(e.style.display="block")):(o&&(o.style.display="block"),r&&(r.style.display="none"),l&&(l.style.display="none"),i&&(i.style.display="none"),e&&(e.style.display="none"))}
